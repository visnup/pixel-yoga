<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1,user-scalable=no" />
    <title>Pixel Yoga</title>
    <style type="text/css">
      body { background-color: white }
    </style>
  </head>
  <body>
    <script>
      pick()

      function pick() {
        var color
        var colors = ['red', 'lime', 'blue', 'magenta', 'white']
        do {
          color = colors[Math.floor(Math.random() * colors.length)]
        } while(color === document.body.style.backgroundColor)

        document.body.style.backgroundColor = color
      }

      var n = 0
      var t0 = Date.now()
      var x0 = y0 = z0 = 0
      window.addEventListener('deviceorientation', function(event) {
        var dx = Math.abs(event.alpha - x0)
        var dy = Math.abs(event.beta  - y0)
        var dz = Math.abs(event.gamma - z0)

        var v = Math.max(dx, dy, dz)
        if (v > 180) v = 360 - v
        if (v > 90) v = 180 - v

        x0 = event.alpha
        y0 = event.beta
        z0 = event.gamma

        /*
        document.body.innerText = `
          alpha: ${event.alpha}
          beta: ${event.beta}
          gamma: ${event.gamma}
        `
        */

        if (v > 16) {
          document.body.innerText = 'v' + v
          var t = Date.now()
          if (t - t0 < 300) {
            n++
            document.body.innerText = n
            if (n > 6) {
              pick()
              n = 0
            }
          } else {
            n = 0
          }

          t0 = t
        }
      })
    </script>
  </body>
</html>
